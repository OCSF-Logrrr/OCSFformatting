# ğŸ“¦ app/ ë””ë ‰í† ë¦¬ ì„¤ëª…

app ë””ë ‰í† ë¦¬ ë‚´ë¶€ì— ìˆëŠ” íŒŒì´ì¬ íŒŒì¼ë“¤ì„ ê°ê° ì„¤ëª…í•©ë‹ˆë‹¤.
í•´ë‹¹ íŒŒì¼ ë‚´ë¶€ì— ìˆëŠ” íŒŒì¼ë“¤ì€ ì¼ë ¨ëœ ê³¼ì •ì„ ê±°ì³ ì›ë³¸ ë¡œê·¸ë¥¼ OCSF í˜•íƒœë¡œ ë³€í™˜í•˜ì—¬ ë‹¤ì‹œ ELK ì„œë²„ë¡œ ë³´ëƒ…ë‹ˆë‹¤.

`app/` ë””ë ‰í† ë¦¬ëŠ” ë¡œê·¸ ìˆ˜ì§‘ â†’ ë¶„ë¥˜(classify) â†’ ì •ê·œí™”(mapping) â†’ ì „ì†¡ê¹Œì§€ì˜ ì „ì²˜ë¦¬ í•µì‹¬ ë¡œì§ì„ í¬í•¨í•©ë‹ˆë‹¤.  
Kafkaë¥¼ í†µí•´ ì „ë‹¬ëœ ì›ë³¸ ë¡œê·¸ë¥¼ OCSF í¬ë§·ìœ¼ë¡œ ì •ê·œí™”í•˜ê³ , Elasticsearchë¡œ ì „ì†¡í•˜ê¸° ìœ„í•œ ì¤€ë¹„ ë‹¨ê³„ë¥¼ ë‹´ë‹¹í•©ë‹ˆë‹¤.



---

## ğŸ”„ ë¡œê·¸ ì²˜ë¦¬ íë¦„ê³¼ êµ¬ì„± ìš”ì†Œ ì„¤ëª…

Kafkaë¡œë¶€í„° ìˆ˜ì‹ í•œ ì›ë³¸ ë¡œê·¸ëŠ” ì•„ë˜ì˜ ìˆœì„œë¡œ ì²˜ë¦¬ë˜ì–´ OCSF í¬ë§·ìœ¼ë¡œ ì •ê·œí™”ëœ í›„ ë‹¤ì‹œ Kafkaë¡œ ì „ì†¡ë©ë‹ˆë‹¤.  
ê° ë‹¨ê³„ë³„ ì—­í• ì„ ë‹´ë‹¹í•˜ëŠ” íŒŒì´ì¬ íŒŒì¼ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

| ìˆœì„œ | íŒŒì¼ëª…             | ì„¤ëª… |
|------|--------------------|------|
| â‘  ìˆ˜ì‹  | `stream_loop.py`     | Kafkaì—ì„œ ì›ë³¸ ë¡œê·¸ë¥¼ ì§€ì†ì ìœ¼ë¡œ ì½ì–´ì˜µë‹ˆë‹¤. |
| â‘¡ ë¶„ë¥˜ | `classifier.py`      | ë¡œê·¸ë¥¼ ë¶„ì„í•´ ì–´ë–¤ OCSF í´ë˜ìŠ¤(`class_uid`)ì¸ì§€ íŒë‹¨í•©ë‹ˆë‹¤. |
| â‘¢ ìŠ¤í‚¤ë§ˆ ë¡œë”© | `schema_loader.py`   | í•´ë‹¹ í´ë˜ìŠ¤ì˜ JSON ìŠ¤í‚¤ë§ˆë¥¼ `class_schemas/`ì—ì„œ ë¡œë”©í•©ë‹ˆë‹¤. |
| â‘£ ì •ê·œí™” | `mapping.py`         | ë¶ˆëŸ¬ì˜¨ ìŠ¤í‚¤ë§ˆ ê¸°ì¤€ìœ¼ë¡œ LLMì„ ì´ìš©í•˜ì—¬ ë¡œê·¸ë¥¼ OCSF í¬ë§·ìœ¼ë¡œ ì •ê·œí™”í•©ë‹ˆë‹¤. |
| â‘¤ ì „ì†¡ | `kafka_handler.py`   | ìµœì¢… ì •ê·œí™”ëœ ë¡œê·¸ë¥¼ Kafkaë¡œ ì¬ì „ì†¡í•©ë‹ˆë‹¤. |

> ğŸ’¡ `class_schemas/` í´ë”ì—ëŠ” OCSF í´ë˜ìŠ¤ë³„ ìŠ¤í‚¤ë§ˆ(JSON)ê°€,  
> `configs/keyword.json`ì€ `classifier.py`ì—ì„œ í‚¤ì›Œë“œ ê¸°ë°˜ ë¶„ë¥˜ ê¸°ì¤€ìœ¼ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤.

---


### ì˜ˆì‹œ ë¡œê·¸ íë¦„

#### ğŸŸ¡ ì›ë³¸ ë¡œê·¸ (ì…ë ¥)

Jun 14 18:22:00 ubuntu sshd[1483]: Accepted password for user1 from 192.168.0.1 port 51234 ssh2

#### ğŸŸ¢ OCSF ì •ê·œí™” ê²°ê³¼ (ì¶œë ¥)
```
json
{
  "class_uid": 3001,
  "class_name": "Authentication",
  "user": { "name": "user1" },
  "src_endpoint": { "ip": "192.168.0.1", "port": 51234 },
  "status": "Success"
}
```
